from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, CallbackQueryHandler, filters, ContextTypes
from dotenv import load_dotenv
from telegram.error import Conflict
import time
import os

COMMANDS = [
    ("start", "Почати роботу з ботом"),
    ("clear", "Очистити чат"),
    ("restart", "Перезапустити бота"),
    ("stop", "Зупинити бота")
]

# Завантаження змінних з .env файлу
load_dotenv()

# Отримання токену
TOKEN = os.getenv('TELEGRAM_TOKEN')

# Структура даних для меню
MENU_DATA = {


# ЩО РОБИТИ ЯКЩО
    "what_to_do": {
    "title": "❓ ЩО РОБИТИ ЯКЩО ❓",
    "content": """<b>Що робити, якщо є підозра про булінг – алгоритм дій</b>

Алгоритм розроблено згідно з наказом МОН від 28.12.2019 №1646 і рекомендацій, підготованих за участі <a href="https://zakon.rada.gov.ua/laws/show/z0111-20#Text">освітнього омбудсмена</a>.

<b>Оберіть розділ алгоритму:</b>""",
    "sections": {
        "first_steps": {
            "title": "ПЕРШІ КРОКИ",
            "content": """<b>ПЕРШІ КРОКИ</b>

У випадках підозри чи виявлення булінгу важливо діяти швидко та послідовно. Своєчасне реагування допомагає захистити постраждалу дитину та запобігти подальшому розвитку конфлікту.

Нижче наведено покроковий алгоритм дій, розроблений згідно з офіційними рекомендаціями МОН України. Дотримання цих кроків допоможе забезпечити ефективне реагування на ситуацію булінгу в закладі освіти.

Оберіть конкретний крок для отримання детальної інформації:""",
            "steps": {
                "step1": {
                    "title": "Крок 1",
                    "content": """<b>Крок 1</b>

Необхідно повідомити директору школи про випадок булінгу або підозру щодо нього. Це можуть зробити всі учасники освітнього процесу: учні, батьки та педагоги.

Повідомлення мають прийматись усно або письмово, особисто або засобами електронної комунікації.

"Чому це важливо проговорити для вчителів? Тому що часто ми схильні менше приділяти уваги саме усним повідомленням або повідомленням в груповому чаті. Проте всі ці повідомлення від батьків і учнів необхідно вважати саме заявою про булінг", – зазначає Анна Овдієнко.

Проте вона радить звертатися письмово і казати про це батькам та учням: "У такому випадку є чітка заява – задокументована, з датою, з реєстраційним номером. У випадку, якщо щось буде зроблено неправильно або дій не буде вжито, письмова заява буде доказом для звернення в інші інстанції"."""
                },
                "step2": {
                    "title": "Крок 2",
                    "content": """<b>Крок 2</b>

Директор впродовж першої доби від отримання повідомлення має обов'язково повідомити про випадок:

• поліції;
• батькам учнів-учасників булінгу;
• службі у справах дітей для того, щоби з'ясувати причини випадку булінгу та усунути їх, а також для соціального захисту дітей, які стали сторонами булінгу;
• додатково – центру соціальної служби для сім'ї та молоді. Цей центр має оцінити потреби сторін булінгу, визначити методи соціальної роботи, визначити та потім надати соціальні послуги, забезпечити психологічну підтримку.

<b>Важливо:</b> Якщо трапився випадок, через який дитина потребує медичної допомоги, то директор обов'язково має викликати швидку."""
                },
                "step3": {
                    "title": "Крок 3",
                    "content": """<b>Крок 3</b>

Директор має скликати засідання комісії з розгляду випадку булінгу впродовж 3-х робочих днів із дня отримання заяви або повідомлення.

Комісія може розглядати заяву не більше 10-ти робочих днів із дня отримання заяви або повідомлення керівником закладу освіти."""
                }
            }
        },
        "committee": {
            "title": "КОМІСІЯ І ЗАСІДАННЯ",
            "content": """<b>КОМІСІЯ І ЗАСІДАННЯ</b>

Комісія має бути затверджена на початку навчального року. Постійний склад:

• голова (зазвичай це директор);
• педагогічні працівники;
• практичний психолог;
• соціальний педагог;
• представник служби у справах дітей;
• представник центру соціальних служб для сім'ї, дітей та молоді.

Варіативний склад комісії: батьки, сторони булінгу та інші представники суб'єктів реагування (органи місцевого самоврядування, засновник закладу освіти або уповноважений ним орган та територіальні органи національної поліції).""",
            "subsections": {
                "meeting_process": {
                    "title": "Як відбувається засідання комісії",
                    "content": """<b>Як відбувається засідання комісії:</b>

1. Секретар має повідомити всім членам, заявнику та іншим зацікавленим особам про порядок денний засідання, дату, час і місце проведення, надати або надіслати необхідні матеріали. Це все має відбуватися не пізніше 18-ї години за день до засідання комісії. Тобто, якщо засідання заплановано на вівторок, то не пізніше, ніж о 18-й годині понеділка мають бути поінформовані всі члени комісії.

2. Щоби засідання вважалося правомірним, повинні бути <b>⅔</b> її членів. Рішення комісія ухвалює більшістю голосів через відкрите голосування. У випадку, якщо голоси розділилися навпіл, останнім голосом є голос директора, оскільки він є головою комісії.

3. Протягом засідання секретар комісії веде протокол. Є форма цього протоколу, згідно з <a href="https://zakon.rada.gov.ua/laws/show/z0111-20#Text">додатком до наказу</a>.

4. У протоколі зазначається, які рішення ухвалює комісія, визначено потреби сторін булінгу в соціальних та психолого-педагогічних послугах, перераховано їх. А також – які мають бути вжиті інші заходи для усунення причин булінгу, рекомендації для педпрацівників, батьків або інших законних представників неповнолітньої особи.

5. Керівник закладу освіти наказом має оформити протокол засідання комісії.

Діяльність комісії не закінчується на тому, щоби визначити, що робити. Після вжитих заходів вона має далі збиратися на заплановані засідання і моніторити ефективність заходів виховного впливу, визначати, чи треба їх коригувати."""
                }
            }
        },
        "situations": {
            "title": "ПРИКЛАДИ СИТУАЦІЙ",
            "content": """<b>ПРИКЛАДИ СИТУАЦІЙ</b>

Оберіть ситуацію для ознайомлення:""",
            "examples": {
                "situation1": {
                    "title": "Ситуація 1",
                    "content": """<b>Ситуація 1</b>

<i>"Протягом 5 років мою доньку та інших дітей класу тероризують кілька однокласників. Батьки неодноразово проводили збори, на яких писали заяви директорці з проханням розібратись. Директорка заяви приймала, а допомоги жодної. У нас все добре, говорила вона. Тільки за цей рік донька отримала два синці на обличчі та неодноразово чула погрози".</i>

<b>Що було правильно:</b> Відповідно до алгоритму, правильно було те, що батьки звернулися до директора, що була написана заява. Заклад освіти правильно зробив, що її зареєстрував.

<b>Що було не правильно:</b> жодних дій далі не вживалось.

Анна Овдієнко додає: "Часто кажуть, що це була гра, одноразова ситуація, конфлікт, і його вже залагоджено. З цього звернення ми бачимо, що говориться про кілька випадків нанесення шкоди, цькування. Тобто, є систематичність. Систематичність – важлива ознака булінгу, яка відрізняє булінг від одноразового конфлікту"."""
                },
                "situation2": {
                    "title": "Ситуація 2",
                    "content": """<b>Ситуація 2</b>

<i>Людина звернулась зі скаргою на урядову гарячу лінію за номером 1545 про булінг та мобінг у закладі: "Обіцяли протягом 5 днів створити комісію для перевірки. Не припиняється систематичне цькування. Почалися перевірки педагогів, які підтримують жертву".</i>

<b>Що було неправильно:</b>

1. Комісію обіцяли створити протягом 5 днів, хоча вона має бути вже створена. Коли відбувається булінг, комісія скликається, а не створюється.

2. Комісія має бути скликана не протягом 5-ти, а протягом 3-х робочих днів."""
                },
                "situation3": {
                    "title": "Ситуація 3",
                    "content": """<b>Ситуація 3</b>

<i>"На уроці учень А вдарив учня Б, унаслідок чого учень Б отримав закриту черепно-мозкову травму та струс головного мозку. Після цього учень Б намагався звернутися по допомогу до директорки, але та до дитини не вийшла. Потім учень Б піднімався сходами, де сталася друга сутичка. Учень Б самостійно звернувся до медичної сестри, яка зателефонувала батькам через те, що виявила симптоми струсу.

Батьки не мали змоги забрати учня й попросили викликати швидку допомогу. Директорка забороняла викликати швидку. Після заяви батьків про булінг було скликано комісію з розгляду випадків булінгу. За результатами засідання, було складено акт про нещасний випадок, де заперечували факти вчинення насильства. Учень А під час роботи комісії та після розгляду продовжував погрожувати учню Б та його сестрі".</i>

<b>Що було неправильно:</b>

1. Директорка не мала права не реагувати. Учень може звернутись навіть усно. Вона мала прийняти заяву та викликати швидку допомогу.

2. Учителька була свідком. Вона мала втрутитися й потім повідомити про випадок.

3. "Ми не можемо це визнати булінгом або нещасним випадком. Комісія не є судом. Шкільна комісія мала залагодити ситуацію, розробити рекомендації. Усе це називається булінгом, проте законодавчо термін "булінг" та адміністративну відповідальність визначає лише суд", – каже Анна Овдієнко.

Повноваження шкільної комісії – це дізнатись причини ситуації, визначити, що робити, моніторити ефективність вжитих дій."""
                }
            }
        },
        "difficulties": {
            "title": "ТРУДНОЩІ, ЯКІ МОЖУТЬ ВИНИКНУТИ",
            "content": """<b>ТРУДНОЩІ, ЯКІ МОЖУТЬ ВИНИКНУТИ</b>

<b>1. Оціночне ставлення до булера, жертви та свідків.</b>
"З одного боку, оцінки спрощують наше життя. Але з іншого – створюють фільтр, через який ми дивимось на ситуацію. У розгляді булінгу такий фільтр стає перешкодою для того, щоб об'єктивно сприймати інформацію.

Це збільшує можливість того, що будуть пропущені якісь деталі. Або ж можна своєю поведінкою поглибити ситуацію. Якщо булеру одразу висловити несхвалення поведінкою, спробувати його покарати, назвати булером та тиснути на нього, то імовірніше, цей ярлик буде на дитині й вона далі діятиме так. Краще чинити безоціночно і ставити уточнювальні запитання, щоб учні самі оцінювали свою поведінку", – пояснює Анна Овдієнко.

<b>2. Спокуса вершити правосуддя</b>
"Це про те, що педагогічні працівники виходять із більш владної позиції до учнів. Проте ви не суддя, щоби чітко сказати: ти – маєш рацію, ти – винний, тебе покарано, тебе заохочено. Ваше завдання – не дати оцінку, а створити безпечну платформу для висловлення, щоб учні могли самі оцінити свою поведінку", – каже пані Анна.

<b>3. Особливе (позитивне) ставлення до будь-якої зі сторін.</b>
Важливо уникати особливого ставлення до будь-якої зі сторін. Це може призвести до упередженості в розгляді випадку та прийнятті рішень."""
        }
    }
},


# ТЕЛЕФОНИ ДОВІРИ
    "calling": {
    "title": "📞 ТЕЛЕФОНИ ДОВІРИ 📞",
    "content": """<b>Телефони гарячих ліній:</b>

- Національна дитяча «гаряча лінія»:
  ‣ <b>0 800 500 225</b>
  ‣ <b>116 111</b>

- Кол-центри Міністерства соціальної політики:
  -- з питань протидії торгівлі людьми: <b>1578</b>
  -- з питань протидії насильству: <b>1588</b>

- Національна безкоштовна гаряча лінія з протидії торгівлі людьми
  ‣ <b>0 800 505 501</b>
  ‣ <b>527</b>

- Урядова гаряча лінія з попередження домашнього насильства:
  ‣ <b>1547</b>

- Гаряча телефонна лінія щодо булінгу:
  ‣ <b>116 000</b>

- Гаряча лінія з протидії насильству
  ‣ <b>0 800 500 335</b>
  ‣ <b>116 123</b>

- Гаряча лінія Уповноваженого ВРУ з прав людини
  ‣ <b>0 800 501 720</b>

- Уповноважений Президента України з прав дитини
  ‣ <b>044 255 76 75</b>"""
},


# НОРМАТИВНА БАЗА
"normative": {
        "title": "📚 НОРМАТИВНА БАЗА 📚",
        "content": """<b>Офіційні документи МОН щодо булінгу</b>:

<a href="https://zakon.rada.gov.ua/laws/show/z0111-20">Наказ МОН України від 28.12.2019 №1646</a> "Деякі питання реагування на випадки булінгу (цькування) та застосування заходів виховного впливу в закладах освіти"

<a href="https://zakon.rada.gov.ua/laws/show/z0111-20#n16">📑 ПОРЯДОК реагування на випадки булінгу (цькування)</a>

<a href="https://zakon.rada.gov.ua/laws/show/z0111-20#Text">📑 ПОРЯДОК застосування заходів виховного впливу</a>

<a href="https://zakon.rada.gov.ua/laws/file/text/79/f492944n184.doc">📑 ПРОТОКОЛ засідання комісії з розгляду випадків булінгу (цькування)</a>

<a href="https://nadvirna-lyceum.com/wp-content/uploads/2020/09/1_11-881-1.pdf">Лист МОН України від 29.01.2019 №1/11-881</a> "Рекомендації для закладів освіти щодо застосування норм Закону України «Про внесення змін до деяких законодавчих актів України щодо протидії булінгу (цькуванню)»"

<a href="https://drive.google.com/file/d/1nTDyYVLH7KHAyJYV-rbSa_NZ_ZrEBDxA/view">Лист МОН України від 14.08.2020 №1/9-436</a> "Про створення безпечного освітнього середовища в закладі освіти та попередження протидії булінгу (цькуванню)"

<a href="https://mon.gov.ua/static-objects/mon/uploads/public/661/68c/749/66168c749e942831464207.pdf">Наказ МОН України від 26.02.2020 №293</a> "Про затвердження плану заходів, спрямованих на запобігання та протидію булінгу (цькуванню) в закладах освіти"

<a href="https://rada.info/upload/users_files/24016046/8e78a0ee3a33da80fe57cf0e3792ecca.doc">Лист МОН України від 20.03.2020 №6/480-20</a> "Про план заходів, спрямованих на запобігання та протидію булінгу (цькуванню) в закладах освіти"""

},


# ПОСІБНИКИ
"manuals_categories": {
    "title": "📖 ПОСІБНИКИ 📖",
    "content": "Оберіть категорію посібників:",
    "categories": {
        "unicef": {
            "title": "Поради від UNICEF",
            "description": "Практичні посібники від UNICEF для батьків і педагогів з протидії булінгу та підтримки дітей",
            "materials": {
                "parents_prevention": {
                    "title": "Як батькам і школі запобігти булінгу",
                    "description": """<b>Як батькам і школі запобігти булінгу</b>

<i>Автор: UNICEF Україна</i>

Посібник розкриває практичні підходи до запобігання булінгу через співпрацю батьків і школи. Містить рекомендації щодо розпізнавання булінгу на ранніх стадіях та ефективної протидії.

Основні теми:
- Розпізнавання ознак булінгу
- Профілактичні заходи в школі
- Стратегії для батьків
- Формування безпечного середовища для дітей

Рекомендовано для батьків та педагогів.""",
                    "pdf_url": "https://drive.google.com/file/d/1AjAdZIZVQxhamk7WUw01a0EeUIRYQ-VB/view?usp=drive_link"
                },
                "victim_support": {
                    "title": "Як допомогти дитині, яка стала жертвою булінгу",
                    "description": """<b>Як допомогти дитині, яка стала жертвою булінгу</b>

<i>Автор: UNICEF Україна</i>

Посібник містить рекомендації щодо підтримки дитини, яка зазнала цькування. Описано психологічні аспекти травми від булінгу та шляхи допомоги дитині.

Основні теми:
- Психологічні наслідки булінгу
- Комунікація з дитиною
- Взаємодія зі школою
- Відновлення самооцінки та емоційного благополуччя

Рекомендовано для батьків, психологів та педагогів.""",
                    "pdf_url": "https://drive.google.com/file/d/1g77Ow2KJ_Cr0TWdnInSDU-43GDKhOcMB/view?usp=drive_link"
                },
                "cyberbullying_victim": {
                    "title": "Як допомогти дитині, яка стала жертвою кібербулінгу",
                    "description": """<b>Як допомогти дитині, яка стала жертвою кібербулінгу</b>

<i>Автор: UNICEF Україна</i>

Посібник присвячений особливостям підтримки дітей, які стикнулися з цькуванням в онлайн-просторі. Розглядаються особливості кібербулінгу та його наслідки.

Основні теми:
- Особливості кібербулінгу
- Безпека в цифровому середовищі
- Емоційна підтримка
- Технічні аспекти захисту в інтернеті

Рекомендовано для батьків та підлітків.""",
                    "pdf_url": "https://drive.google.com/file/d/13lMZYQyxeHiRp0Zr-efgOm3Qzvp8P0tQ/view?usp=drive_link"
                },
                "bully_child": {
                    "title": "Що робити, якщо ваша дитина – агресор",
                    "description": """<b>Що робити, якщо ваша дитина – агресор</b>

<i>Автор: UNICEF Україна</i>

Посібник для батьків, чиї діти проявляють агресивну поведінку щодо інших. Розглядаються причини булерської поведінки та способи її корекції.

Основні теми:
- Розпізнавання ознак булерської поведінки
- Розуміння причин агресії
- Стратегії комунікації з дитиною
- Корекція поведінки та цінностей

Рекомендовано для батьків та педагогів.""",
                    "pdf_url": "https://drive.google.com/file/d/1AZxJOQY5IqmQJJb_zspiHy_hFMSRUBKK/view?usp=drive_link"
                }
            }
        },
        "education_system": {
            "title": "Системні посібники для закладів освіти",
            "description": "Методичні матеріали для системної організації роботи з протидії булінгу в закладах освіти",
            "materials": {
                "prevention_in_education": {
                    "title": "Запобігання та протидія проявам насильства",
                    "description": """<b>Запобігання та протидія проявам насильства: діяльність закладів освіти</b>

<i>Автори: Андрєєнкова В.Л., Байдик В.В., Войцях Т.В., Калашник О.А.</i>

Навчально-методичний посібник для працівників закладів освіти. Містить рекомендації щодо побудови системи протидії насильству в освітньому середовищі.

Основні теми:
- Форми насильства в освітньому середовищі
- Організація системної протидії
- Нормативна база
- Практичні заходи профілактики

Рекомендовано для адміністрації закладів освіти та шкільних психологів.""",
                    "pdf_url": "https://drive.google.com/file/d/1aIGa_dLNptQe-LwxU7_OVcTeybsEoQcc/view?usp=drive_link"
                },
                "safe_educational_code": {
                    "title": "Кодекс безпечного освітнього середовища",
                    "description": """<b>Кодекс безпечного освітнього середовища: методичний посібник</b>

<i>Автори: Цюман Т.П., Бойчук Н.І.</i>

Посібник з розробки та впровадження кодексу безпечного освітнього середовища. Детально описано процес створення документа та механізми його імплементації.

Основні теми:
- Принципи безпечного середовища
- Етапи розробки Кодексу
- Впровадження та моніторинг
- Залучення всіх учасників освітнього процесу

Рекомендовано для керівників закладів освіти.""",
                    "pdf_url": "https://drive.google.com/file/d/1BvPMnzKU37ULPwBq_jfC5Eq63QWLA8L1/view?usp=drive_link"
                },
                "bullying_systematic": {
                    "title": "Протидія булінгу в закладі освіти: системний підхід",
                    "description": """<b>Протидія булінгу в закладі освіти: системний підхід</b>

<i>Автори: Сидорук І.І., Петрук Л.А., Андрєєнкова В.Л.</i>

Методичний посібник з організації комплексної роботи щодо протидії булінгу. Представлено системний підхід до вирішення проблеми в межах навчального закладу.

Основні теми:
- Діагностика проявів булінгу
- Розробка антибулінгової політики закладу
- Протоколи реагування на випадки
- Профілактичні програми та заходи

Рекомендовано для адміністрації шкіл та шкільних психологів.""",
                    "pdf_url": "https://drive.google.com/file/d/1CBsWlpEm5Brc6JRViWs2RK4D-ouLR21m/view?usp=drive_link"
                },
                "say_no_bullying": {
                    "title": "Скажемо булінгу ні!",
                    "description": """<b>«Скажемо булінгу ні!»: методичний посібник</b>

<i>Автори: Черепаха К.В., Говорун Т.В., Васильєва О.М.</i>

Комплексний посібник з протидії булінгу для всіх учасників освітнього процесу. Містить теоретичний матеріал та практичні рекомендації.

Основні теми:
- Види та ознаки булінгу
- Профілактика цькування
- Алгоритми реагування
- Практичні вправи та тренінги

Рекомендовано для педагогів, психологів та батьків.""",
                    "pdf_url": "https://drive.google.com/file/d/1VT0Vl3VJBtIcYrBhig30Qi6S9IJViiCr/view?usp=drive_link"
                }
            }
        },
        "mediation": {
            "title": "Вирішення конфліктів та медіація",
            "description": "Матеріали з організації медіації та мирного вирішення конфліктів у закладах освіти",
            "materials": {
                "conflict_resolution": {
                    "title": "Вирішення конфліктів мирним шляхом. Базові навички медіації",
                    "description": """<b>Комплект освітніх програм «Вирішення конфліктів мирним шляхом. Базові навички медіації»</b>

<i>Автори: Андрєєнкова В.Л., Левченко К.Б., Матвійчук М.М.</i>

Освітні програми з розвитку навичок медіації та мирного вирішення конфліктів. Містить теоретичні матеріали та практичні вправи для проведення занять.

Основні теми:
- Основи медіації
- Комунікативні навички
- Етапи вирішення конфліктів
- Практичні вправи та сценарії тренінгів

Рекомендовано для педагогів, психологів та учнів-медіаторів.""",
                    "pdf_url": "https://drive.google.com/file/d/1_cPADXNDtSrSYRd_phNKwJzwG0HDclo3/view?usp=drive_link"
                },
                "reconciliation_services": {
                    "title": "Створення системи служб порозуміння",
                    "description": """<b>Створення системи служб порозуміння для впровадження медіації за принципом «рівний-рівному/рівна-рівній»</b>

<i>Автори: Андрєєнкова В.Л., Войцях Т.В., Дацко О.В., Лунченко Н.В.</i>

Навчально-методичний посібник з організації служб порозуміння в закладах освіти. Детально описано створення та функціонування медіаційних служб.

Основні теми:
- Концепція «рівний-рівному»
- Організаційні аспекти створення служб
- Підготовка медіаторів
- Супровід діяльності служб порозуміння

Рекомендовано для координаторів шкільних служб порозуміння.""",
                    "pdf_url": "https://drive.google.com/file/d/1BQQv4M7TRozZi6o-G0wvFpdMFr6clmXI/view?usp=drive_link"
                }
            }
        },
        "general_info": {
            "title": "Загальні інформаційні матеріали",
            "description": "Інформаційно-просвітницькі матеріали про булінг та шляхи його подолання",
            "materials": {
                "about_bullying": {
                    "title": "Про булінг (цькування) та як його подолати",
                    "description": """<b>Про булінг (цькування) та як його подолати. Дітям, молоді та дорослим про важливе</b>

<i>Автори: Сідєльнік Л.Л., Сушик Н.С., Мостовська А.В.</i>

Інформаційно-просвітницький посібник з основами розуміння явища булінгу. Надає базові знання про цькування та способи протидії.

Основні теми:
- Що таке булінг і чому він виникає
- Ролі учасників булінгу
- Психологічні наслідки
- Практичні поради для всіх вікових груп

Рекомендовано для широкого кола читачів.""",
                    "pdf_url": "https://drive.google.com/file/d/1mkarHeagSijxJvUxI9LxRhG3nMnBxrcW/view?usp=drive_link"
                }
            }
        }
    }
},


# КІБЕРБУЛІНГ
"cyberbullying" : {
    "title": "🛡 КІБЕРБУЛІНГ 🛡",
    "content": """<b>Кібербулінг -- що це та як це зупинити?</b>

Кібербулінг -- це булінг із застосуванням цифрових технологій. Він може відбуватися в соціальних мережах, платформах обміну повідомленнями (месенджерах), ігрових платформах та мобільних телефонах.

Особистий булінг та кібербулінг часто пов'язані між собою. Але кібербулінг залишає цифровий слід -- записи, який може слугувати доказами, що дозволять зупинити цькування.

Оберіть розділ, щоб дізнатися більше:""",
    "submenu": {
        "questions": {
            "title": "❓ ТОП-10 ЗАПИТАНЬ",
            "content": "Оберіть запитання, яке вас цікавить:",
            "questions": {
                "q1": {
                    "short_title": "Різниця між жартом та булінгом",
                    "title": "Чи зазнаю я булінгу в Інтернеті? У чому різниця між жартом та булінгом?",
                    "content": """<b>Чи зазнаю я булінгу в Інтернеті? У чому різниця між жартом та булінгом?</b>

<b>ЮНІСЕФ:</b>

Усі друзі жартують між собою, але іноді важко сказати, чи хтось просто розважається, чи намагається нашкодити вам, особливо в Інтернеті. Іноді вони насміхаються, але говорять, що це «просто жарти» і пропонують «не сприймати це так серйозно».

Але якщо ви відчуваєте образу або думаєте, що інші насміхаються з вас, а не веселяться разом з вами, то жарт зайшов занадто далеко. Якщо це продовжується навіть після того, як ви попросили людину зупинитися, і ви досі відчуваєте себе засмученим/ою, то це може бути булінгом.

А коли знущання відбуваються в Інтернеті, це може призвести до небажаної уваги з боку широкого кола людей, включаючи незнайомих людей. Де б це не сталося, якщо вам це неприємно, ви не маєте цього терпіти.

Як би ця ситуація не називалася: якщо вам погано, і це не припиняється, тоді варто звернутися за допомогою. Для того, щоб зупинити кібербулінг, потрібно не лише закликати кривдників більше так не робити. Необхідно також усвідомити, що будь-яка особа заслуговує на повагу: як в Інтернеті, так і в реальному житті."""
                },
                "q2": {
                    "short_title": "Наслідки кібербулінгу",
                    "title": "До яких наслідків призводить кібербулінг?",
                    "content": """<b>До яких наслідків призводить кібербулінг?</b>

Коли булінг трапляється в Інтернет, може здаватися, що на вас нападають усюди, навіть у власному домі. Може здаватися, що виходу немає. Наслідки можуть тривати довгий час і впливати на людину різними способами:

<b>Ментально</b> -- відчуття смутку, пригніченості, навіть злості, відчуття себе в безглуздому становищі

<b>Емоційно</b> -- відчуття сорому, втрата цікавості до речей, які ти любиш

<b>Фізично</b> -- відчуття втоми (втрата сну) або таких симптомі, як біль у животі та головний біль.

Відчуття того, що з тебе насміхаються або тебе переслідують, може заважати людям говорити або намагатися боротися з проблемою. У крайніх випадках кібербулінг може призвести навіть до скоєння самогубства.

Кібербулінг може впливати на нас багатьма способами. Але це можна подолати, і люди можуть повернути впевненість у собі та здоров'я."""
                },
                "q3": {
                    "short_title": "До кого звернутися",
                    "title": "З ким я маю поговорити, якщо хтось цькує мене в Інтернеті? Чому так важливо про це розповідати?",
                    "content": """<b>З ким я маю поговорити, якщо хтось цькує мене в Інтернеті? Чому так важливо про це розповідати?</b>

<b>ЮНІСЕФ:</b>

Якщо ви думаєте, що відчуваєте булінг, перший крок -- це звернутися за допомогою до когось, кому ви довіряєте, наприклад, до ваших батьків, близького члена сім'ї чи іншого дорослого, якому ви довіряєте.

У своїй школі ви можете звернутися до психолога, спортивного тренера чи улюбленого вчителя.

А якщо вам не зручно спілкуватися з кимось, кого ви знаєте, пошукайте гарячу лінію у своїй країні, щоб поговорити з професійним консультантом.

Якщо булінг трапляється на соціальній платформі, подумайте про блокування кривдника та офіційно повідомте про його/її поведінку на самій платформі. Соціальні мережі зобов'язані підтримувати безпеку своїх користувачів.

Це може бути корисно для збору доказів: текстових повідомлень та скріншотів публікацій у соціальних мережах, щоб показати, що відбувається.

Щоб булінг припинився, його потрібно ідентифікувати Ключове -- це повідомити про нього. Це також може допомогти показати кривдникам, що їх поведінка неприйнятна.

Якщо вам загрожує безпосередня небезпека, слід звернутися до поліції чи служб швидкої допомоги у вашій країні."""
                },
                "q4": {
                    "short_title": "Як розповісти батькам",
                    "title": "Я зазнаю кібербулінгу, але боюся говорити про це з батьками. Якими словами я можу розповісти їм про це?",
                    "content": """<b>Я зазнаю кібербулінгу, але боюся говорити про це з батьками. Якими словами я можу розповісти їм про це?</b>

Якщо ви зазнаєте кібербулінгу, один із найважливіших перших кроків, які ви можете зробити -- поговорити з дорослим, якому ви довіряєте (з кимось, з ким ви почуваєтеся безпечно).

Не всім просто розмовляти зі своїми батьками. Але є речі, які ви можете зробити, щоб полегшити таку розмову. Оберіть такий час для розмови, коли, на вашу думку, вони можуть приділити вам всю свою увагу. Поясніть, наскільки серйозною для вас є ця проблема. Пам'ятайте, що вони можуть не так добре знатися на інформаційних технологіях, як ви, тому вам може бути потрібно допомогти їм зрозуміти, що відбувається.

Вони можуть не мати моментальних відповідей для вас, але вони, ймовірно, будуть хотіти допомогти вам, і разом ви зможете знайти рішення. Дві голови завжди кращі, ніж одна! Якщо ви досі не впевнені, що робити, подумайте про те, щоб звернутися до інших людей, яким ви довіряєте. Часто таких людей, які піклуються про вас і готові допомогти, більше, ніж ви могли подумати!"""
                },
                "q5": {
                    "short_title": "Як допомогти друзям",
                    "title": "Як я можу допомогти своїм друзям повідомляти про випадки кібербулінгу, особливо якщо вони не хочуть цього робити?",
                    "content": """<b>Як я можу допомогти своїм друзям повідомляти про випадки кібербулінгу, особливо якщо вони не хочуть цього робити?</b>

<b>ЮНІСЕФ:</b>

Жертвою кібербулінгу може стати будь-хто. Якщо ви бачите, що це відбувається з кимось, кого ви знаєте, спробуйте запропонувати підтримку.

Важливо вислухати свого друга. Чому він/вона не хоче повідомити про те, що він/вона зазнає кібербулінгу? Як вони почуваються? Скажіть їм, що вони не зобов'язані офіційно повідомляти про те, що відбувається, але важливо поговорити з кимось, хто може допомогти.

Пам'ятайте: ваш друг може відчувати себе незахищеним. Будьте добрими до нього/неї. Допоможіть їм продумати, що вони можуть сказати і кому. Пропонуйте піти з ними, якщо вони вирішать повідомити про булінг. Найголовніше, нагадайте їм, що ви підтримуєте їх і хочете допомогти.

Якщо ваш друг досі не хоче повідомити про випадок, допоможіть йому/її у пошуку дорослого, якому він/вона довіряє та який може допомогти їм вирішити ситуацію. Пам'ятайте, що в певних ситуаціях наслідки кібербулінгу можуть бути небезпечними для життя.

Якщо нічого не робити, людині може здаватися, що всі налаштовані проти неї або що всім байдуже. Ваші слова підтримки можуть мати вирішальне значення."""
                },
                "q6": {
                    "short_title": "Безпека в інтернеті",
                    "title": "Як можна зупинити кібербулінг, не відмовляючись від доступу до Інтернету?",
                    "content": """<b>Користування Інтернетом дає мені доступ до великої кількості інформації; але це також означає, що я відкритий/а до цькування. Як можна зупинити кібербулінг, не відмовляючись від доступу до Інтернету?</b>

<b>ЮНІСЕФ:</b>

Доступ до Інтернету дає так багато переваг. Однак, як і багато речей у житті, він також створює ризики, від яких потрібно захиститись.

Якщо ви зазнаєте кібербулінгу, ви можете видалити певні програми або залишитись у режимі офлайн на деякий період, щоб дати собі час на відновлення. Але вихід з Інтернету не є довгостроковим рішенням. Ти не зробив/ла нічого поганого, то чому ти маєш опинятися в невигідному становищі? Таке рішення навіть може наводити кривдників на неправильну думку, заохочуючи їх неприйнятну поведінку.

Ми всі хочемо, щоб кібербулінг припинився. Саме тому настільки важливо повідомляти про такі випадки. Але для створення такого середовища в Інтернеті, якого ми хочемо, недостатньо лише закликати тих кривдників, які вже скоюють булінг, припиняти його. Ми маємо задуматися над тим, що ми поширюєте чи говоримо: чи не завдає це шкоди або страждань іншим людям. Ми маємо бути добрими до інших людей в Інтернеті та в реальному житті. Це стосується всіх нас!"""
                },
                "q7": {
                    "short_title": "Захист особистої інформації",
                    "title": "Як я можу запобігти тому, щоб моя особиста інформація використовувалася для маніпуляцій або приниження мене в соціальних мережах?",
                    "content": """<b>Як я можу запобігти тому, щоб моя особиста інформація використовувалася для маніпуляцій або приниження мене в соціальних мережах?</b>

Добре подумайте, перш ніж публікувати або ділитися будь-чим в Інтернеті -- це може залишитися в Інтернеті назавжди і може бути пізніше використане вам на шкоду. Не вказуйте особисті дані, такі як ваша адреса, номер телефону чи назва/номер вашої школи.

Дізнайтеся про налаштування конфіденційності улюблених додатків у соціальних мережах. Ось декілька дій, які ви можете вжити у більшості з них:

-   Ви можете вирішити, хто може бачити ваш профіль, надсилати вам повідомлення або коментувати ваші публікації, скоригувавши налаштування конфіденційності вашого облікового запису.

-   Ви можете повідомляти про образливі коментарі, повідомлення та фотографії та вимагати їх видалення.

-   Окрім «видалення з друзів», ви можете повністю заблокувати окремих користувачів, щоб вони не могли бачити ваш профіль або надсилати вам повідомлення.

-   Ви також можете зробити так, щоб коментарі окремих користувачів бачили лише вони самі, не блокуючи їх повністю.

-   Ви можете видаляти публікації зі свого профілю або ховати їх від певних людей.

У більшості улюблених вами соціальних мереж люди не отримують сповіщення про те, що ви їх заблокували, обмежили або поскаржилися на них."""
                },
                "q8": {
                    "short_title": "Юридична відповідальність",
                    "title": "Чи передбачено покарання за кібербулінг?",
                    "content": """<b>Чи передбачено покарання за кібербулінг?</b>

<b>ЮНІСЕФ:</b>

Більшість шкіл ставляться до булінгу серйозно і вживатимуть заходів проти цього. Якщо ви зазнаєте кібербулінгу з боку інших учнів, повідомте про це в своїй школі.

Люди, які стали жертвами будь-якої форми насильства, включаючи булінг та кібербулінг, мають право на справедливість та притягнення кривдника до відповідальності.

Закони, що забороняють булінг, особливо кібербулінг, є відносно новими і поки що прийняті не в усіх країнах. Ось чому багато країн для протидії кібербулінгу використовують інші відповідні закони, наприклад, законодавство проти домагань.

У країнах, які мають спеціальні закони проти кібербулінгу, поведінка в Інтернеті, яка навмисно викликає серйозні емоційні негаразди, розглядається як злочинна діяльність. У деяких із цих країн жертви кібербулінгу можуть шукати захисту, забороняти спілкування із визначеною особою та вимагати обмеження використання кривдником електронних пристроїв, за допомогою яких він/вона скоює кібербулінг. Таке обмеження може бути тимчасовим чи постійним.

Однак важливо пам'ятати, що покарання -- це не завжди найефективніший спосіб змінити поведінку кривдників. Часто краще зосередитись на подоланні шкоди та налагодженні відносин."""
                },
                "q9": {
                    "short_title": "Відповідальність платформ",
                    "title": "Як здається, Інтернет-провайдери, не переймаються проблемою кібербулінгу та онлайн-домагань? Чи несуть вони відповідальність?",
                    "content": """<b>Як здається, Інтернет-компанії не переймаються проблемою кібербулінгу та онлайн-домагань? Чи несуть вони відповідальність?</b>

Інтернет-компанії все частіше звертають увагу на проблему кібербулінгу.

Багато з них запроваджують способи вирішення цієї проблеми та краще захищають своїх користувачів за допомогою нових інструментів, порад та можливостей повідомляти про порушення їхніх прав в Інтернеті.

Але очевидно, що потрібно робити ще більше. Багато молодих людей щодня зазнають кібербулінгу. Деякі стикаються з крайніми формами насильства в Інтернеті. Деякі в результаті цього скоїли самогубство.

Технологічні компанії несуть відповідальність за захист своїх користувачів, особливо дітей та молоді.

Притягувати їх до відповідальності, коли вони не дотримуються цих обов'язків -- наше спільне завдання."""
                },
                "q10": {
                    "short_title": "Інструменти проти булінгу",
                    "title": "Чи є в Інтернеті будь-які інструменти для боротьби з булінгом, якими можуть скористатися діти та молодь?",
                    "content": """<b>Чи є в Інтернеті будь-які інструменти для боротьби з булінгом, якими можуть скористатися діти та молодь?</b>

<b>ЮНІСЕФ:</b>

Кожна соціальна платформа пропонує різні інструменти, які дозволяють вам обмежити тих, хто може коментувати або переглядати ваші публікації чи хто може автоматично ставати вашим другом, а також повідомляти про випадки булінгу. Багато з них передбачають прості кроки для того, щоб заблокувати користувача, припинити отримувати сповіщень від нього/неї або поскаржитися на кібербулінг. Ми радимо вивчити ці інструменти.

Соціальні мережі також надають освітні інструменти та рекомендації дітям, батькам та вчителям, щоб дізнатися про ризики та способи залишатися в безпеці в Інтернеті.

Окрім того, важливу роль у захисті від кібербулінгу можете зіграти ви. Подумайте, де у вашій громаді трапляється кібербулінг, та про способи, якими ви можете допомогти постраждалим: голосніше про це говорити, закликати кривдників припинити кібербулінг, звертатися до дорослих, яким ви довіряєте, або підвищувати обізнаність про цю проблему. Навіть простий акт доброти може змінити дуже багато.

Якщо ви переживаєте за свою безпеку або за щось, що трапилося з вами в Інтернеті, терміново поговоріть з дорослим, якому ви довіряєте. Або зверніться за підтримкою на гарячу лінію допомоги дітям та молоді. На таку лінію можна зателефонувати безкоштовно та поговорити, не називаючи свого імені."""
                }
            }
        },
        "resources": {
            "title": "🔍 КОРИСНІ РЕСУРСИ",
            "description": """<b>Корисні ресурси для протидії кібербулінгу</b>

Якщо ви зазнаєте кібербулінгу, ви можете звернутися за допомогою через:

1. <b>Національна дитяча гаряча лінія</b>:
   ‣ 0 800 500 225
   ‣ 116 111

2. <b>Посібники соціальних мереж з безпеки</b>:
   ‣ <a href="https://www.facebook.com/safety/bullying/teens">Facebook</a>
   ‣ <a href="http://safety.instagram.com/">Instagram</a>
   ‣ <a href="https://help.twitter.com/en">Twitter</a>

3. <b>Центр безпеки в інтернеті для дітей</b>:
   ‣ <a href="https://stop-sexting.in.ua/">Stop-sexting</a>"""
        },
        
        # Оновлений розділ "campaign_materials" для структури MENU_DATA
        "campaign_materials": {
            "title": "📣 МАТЕРІАЛИ КАМПАНІЇ",
            "content": """<b>Матеріали кампанії проти кібербулінгу</b>

Всеукраїнська кампанія проти кібербулінгу Docudays UA розробила освітні та інформаційні матеріали для підвищення обізнаності про проблему кібербулінгу та інструменти протидії онлайн-цькуванню.

Стрімкий розвиток інформаційних та комунікаційних технологій створює не лише можливості, але й ризики для дітей та підлітків. За даними дослідження ЮНІСЕФ, кожен п'ятий український підліток віком 10-17 років визнає себе жертвою онлайн-знущань.

В цьому розділі ви знайдете:""",
            "materials": {
                "videos": {
                    "title": "🎬 Анімаційні відеоролики",
                    "description": """<b>Анімаційні відеоролики про кібербулінг</b>

<i>Колекція анімаційних роликів, створених на основі реальних історій школярів, які змогли успішно захиститися від кібербулінгу:</i>
                    
<a href="https://youtu.be/2GQdfpdfvZA?list=PLX1eArNhvY8iZrDgzTkzYk_pHfxYftyL9">(дивитися) </a><b>"Кібербулінг. Як я перестала бути жертвою"</b>
<code><i>✏️ реальна історія школярки Катерини Кусмарової</i>
<b>🎥 автор ролика:</b> Денис Сполітак, режисер, художник-аніматор</code>


<a href="https://youtu.be/KuCuc6jcKUc?list=PLX1eArNhvY8iZrDgzTkzYk_pHfxYftyL9">(дивитися) </a><b>"Mr. Nox"</b>
<code><i>✏️ реальна історія школярки Марти Новосад</i>
<b>🎥 авторка ролика:</b> Діана Денис, художниця-аніматорка</code>


<a href="https://youtu.be/8UWlFN4zV9Y?list=PLX1eArNhvY8iZrDgzTkzYk_pHfxYftyL9">(укр. суб.)</a>|<a href="https://youtu.be/KHWR4755_Gc?list=PLX1eArNhvY8iZrDgzTkzYk_pHfxYftyL9">(англ. суб.) </a><b>"Як я став кіберсупергероєм"</b>
<code><i>✏️ реальна історія школяра Дмитра Федоренка</i>
<b>🎥 автори:</b> Тереза Яковина (художниця, сценографка) і Юрій Юдін (фільммейкер)
<b>🎙 автор тексту та музики:</b> Дмитро Федоренко</code>""",
                },
                "info_booklet": {
                    "title": "📄 Інформаційний буклет",
                    "description": """<b>Інформаційний буклет для батьків та дітей</b>

Інформаційний буклет, розроблений експертами <b>Docudays UA</b>, допоможе:

🔗 зрозуміти, що таке кібербулінг і як його розпізнати;
🔗 дізнатися, як захистити себе або свою дитину від онлайн-цькування;
🔗 отримати інформацію про те, куди звертатися по допомогу, якщо ви або ваша дитина опинились у ситуації кібербулінгу.

Буклет структурований простою і зрозумілою мовою та містить практичні поради для різних ситуацій.
        
        <a href="https://cyber.bullyingstop.org.ua/storage/media-archives/cyberbulling_booklet_2_preview.pdf">📕<b> Переглянути pdf-версію </b></a>""",
                },
                "discussion_scenario": {
                    "title": "🗣️ Сценарій обговорення",
                    "description": """<b>Сценарій обговорення: «Кібербулінг: як проблему перетворити в рішення?»</b>

Методичні матеріали для проведення групових обговорень на тему кібербулінгу з підлітками. Сценарій включає:

🔗 структуру обговорення;
🔗 ключові питання для дискусії;
🔗 практичні вправи для роботи в групах;
🔗 рекомендації для модератора.

Матеріал допоможе педагогам, психологам та соціальним працівникам організувати змістовне обговорення проблеми кібербулінгу та допомогти учасникам знайти конструктивні рішення.
        
        <a href="https://cyber.bullyingstop.org.ua/storage/media-archives/docudays_cyberbullying_stsenariy-obhovorennya-rolykiv.pdf">📕<b> Переглянути pdf-версію </b></a>""",
                },
                "research": {
                    "title": "📊 Аналітичні звіти",
                    "description": """<b>Аналітичні звіти про кібербулінг в Україні</b>

Експертні дослідження з питань кібербулінгу серед дітей та підлітків в Україні:

<a href="https://cyber.bullyingstop.org.ua/storage/media-archives/cyberbuling_%D0%B2%D0%B8%D0%BF%D1%80%D0%B0%D0%B2%D0%BB15-10_compressed.pdf"><b>📑 "Попередження та протидія кібербулінгу в дитячому середовищі України"</b></a>
    <i>Комплексне дослідження ситуації з кібербулінгом в Україні, аналіз українського та міжнародного законодавства, найкращі світові практики з попередження і протидії онлайн-цькуванню.</i>

<a href="https://cyber.bullyingstop.org.ua/storage/media-archives/%D0%9F%D1%80%D0%BE%D1%82%D0%B8%D0%B4%D1%96%D1%8F%20%D0%BA%D1%96%D0%B1%D0%B5%D1%80%D0%B1%D1%83%D0%BB%D1%96%D0%BD%D0%B3%D1%83%20%D1%82%D0%B0%20%D0%BA%D1%96%D0%B1%D0%B5%D1%80%D0%B3%D1%80%D1%83%D0%BC%D1%96%D0%BD%D0%B3%D1%83%20%D0%B2%20%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D1%96.pdf"><b>📑 "Протидія кібербулінгу та кібергрумінгу в Україні"</b></a>
    <i>Огляд стану справ з протидії кібербулінгу та кібергрумінгу в Україні на основі аналізу відповідності національного законодавства міжнародним та регіональним стандартам.</i>""",
                },
                "help_centers": {
                    "title": "☎️ Куди звернутись по допомогу",
                    "description": """<b>Куди можна звернутись у разі кібербулінгу</b>

Якщо ви або ваша дитина стали жертвою кібербулінгу, ви можете звернутися за допомогою до цих організацій:

1. <a href="https://www.helsinki.org.ua/"><b>Українська Гельсінська спілка з прав людини (УГСПЛ)</b></a>
Кваліфікована юридична допомога дітям та/чи батькам дітей, які опинились у ситуації кібербулінгу.
Телефони київської приймальні: (044) 383 9519, 094 928 6519 (будні, 10:00-18:00)

2. <a href=""><b>Національна дитяча «гаряча» лінія</b></a>
Професійні психологи і юристи допоможуть розібратися зі складнощами, пов'язаними з цькуванням в онлайні.
Безкоштовний номер: 0 800 500 225 або короткий номер: 116 111 (будні, 12:00-16:00)

3. <a href=""><b>Поліція</b></a>
Номер 102 (цілодобово)

4. <a href=""><b>Правова допомога</b></a>
Єдиний контакт-центр: 0 800 213 103 (цілодобово, безкоштовно в межах України)

5. <a href=""><b>Уповноважений Верховної Ради України з іправ людини</b></a>
Телефони: 8 800 501 720, (044) 253 7589

6. <a href=""><b>Освітній омбудсмен</b></a>
Допомога в захисті прав учнів та студентів, юридична та психологічна підтримка.
Подати звернення можна на сайті: https://eo.gov.ua/""",
                }
            }
        },
        "docu_week": {
            "title": "🎬 ШКІЛЬНИЙ DOCU/ТИЖДЕНЬ",
            "content": """<b>ШКІЛЬНИЙ DOCU/ТИЖДЕНЬ</b>

        Проект "Шкільний DOCU/ТИЖДЕНЬ проти булінгу" — це ініціатива Міжнародного фестивалю документального кіно про права людини Docudays UA. Мета проекту — допомогти школам ефективно протидіяти булінгу та кібербулінгу через перегляд та обговорення документальних фільмів.

        У 2019 році в проекті взяли участь 320 загальноосвітніх навчальних закладів по всій Україні. Проект допомагає говорити про складне за допомогою реальних історій з життя, стимулювати дискусії та формувати довірливі стосунки між учнями, вчителями та батьками.

        DOCU/ТИЖДЕНЬ — це:
        - Перегляд документальних фільмів про права людини
        - Обговорення проблеми булінгу через призму реальних історій
        - Розробка спільних правил безпечного простору в школі
        - Підвищення обізнаності учнів про наслідки булінгу

        Оберіть розділ, щоб дізнатися більше:""",
            "materials": {
                "methodical": {
                    "title": "📚 Методичні матеріали",
                    "description": """<b>Методичні матеріали для проведення DOCU/ТИЖНЯ</b>

        Матеріали для вчителів та психологів, які допоможуть організувати та провести DOCU/ТИЖДЕНЬ у своїй школі. Вони містять:

        - Сценарії показів та обговорень документальних фільмів
        - Рекомендації щодо модерування дискусій на складні теми
        - Практичні вправи для роботи з учнями
        - Інструкції з адаптації програми для різних вікових груп
        - Поради щодо залучення батьків до обговорення

        Ці матеріали зібрані на основі досвіду проведення DOCU/ТИЖНЯ в 320 школах України та можуть допомогти у розробці програм попередження та протидії булінгу й кібербулінгу в школах.""",
                    "url": "https://drive.google.com/drive/folders/1yOq1n2-_O4dmnzQYRg-1lmHfpd9X2pS5?usp=sharing"
                },
                "films": {
                    "title": "🎞️ Фільми та обговорення",
                    "description": """<b>Документальні фільми та матеріали для обговорення</b>

        Підбірка документальних фільмів про булінг та кібербулінг, які можна використати для проведення DOCU/ТИЖНЯ у вашій школі. Кожен фільм супроводжується методичкою з рекомендаціями для обговорення.

        Після перегляду документальної стрічки варто провести обговорення побаченого. Це допоможе учням:
        - Краще усвідомити проблему булінгу
        - Зрозуміти наслідки цькування для всіх учасників
        - Навчитися розпізнавати ситуації булінгу
        - Розвинути емпатію до жертв булінгу
        - Знайти власні способи протидії цій проблемі

        За результатами проведення DOCU/ТИЖНЯ в школах учасники відзначали, що перегляд реальних історій викликав сильні емоції: "Були і сльози, і гострі суперечки". Це дає поштовх до відкритої розмови про проблему булінгу.""",
                    "url": "https://drive.google.com/drive/folders/1xRbV8l5Y3TlsU9CJwQrVDZxT4HjY8mBs?usp=sharing"
                },
                "faq": {
                    "title": "❓ Питання/відповіді",
                    "description": """<b>Поширені запитання про проведення DOCU/ТИЖНЯ</b>

        <b>На що потрібно звернути увагу під час заповнення заявки на участь?</b>
        Важливо вказати мотивацію школи, наявне обладнання та досвід проведення подібних заходів.

        <b>Чи допоможете ви мені підготуватися до проведення DOCU/ТИЖНЯ?</b>
        Так, школи-учасниці отримують методичні матеріали та консультаційну підтримку.

        <b>Скільки фільмів необхідно буде показати впродовж DOCU/ТИЖНЯ?</b>
        Рекомендується показати 2-3 фільми, але кількість можна адаптувати під потреби вашої школи.

        <b>Яке обладнання знадобиться школі для проведення DOCU/ТИЖНЯ?</b>
        Комп'ютер, проектор, екран та звукове обладнання для показу фільмів, а також приміщення для обговорення.

        <b>Участь у проєкті є безкоштовною?</b>
        Так, участь для шкіл є абсолютно безкоштовною.

        <b>За якими критеріями відбувається відбір до проєкту?</b>
        Враховується мотивація, технічні можливості, географічне розташування та потреби школи.

        <b>Чи можуть брати участь у проєкті коледжі, технікуми, училища тощо?</b>
        Так, проект відкритий для різних типів освітніх закладів.""",
                    "url": "https://bullyingstop.org.ua/school"
                },
                "news": {
                    "title": "📰 Новини та результати",
                    "description": """<b>Новини та результати проведення DOCU/ТИЖНЯ</b>

        <b>«Були і сльози, і гострі суперечки». Два місяці DOCU/ТИЖНЯ по всій Україні</b>
        Протягом жовтня та листопада 2019 року школи з різних куточків України взяли участь у проєкті DOCU/ТИЖДЕНЬ проти булінгу. Учні, вчителі та батьки долучились до перегляду документальних фільмів та обговорення проблеми булінгу.

        <b>Провести DOCU/ТИЖДЕНЬ проти булінгу змогли 320 шкіл</b>
        Через великий інтерес до проекту організатори збільшили кількість учасників з 200 до 320 навчальних закладів, щоб дати можливість більшій кількості учнів та вчителів побачити документальне кіно та поговорити про складну проблему — булінг.

        <b>Географія проекту</b>
        У проекті взяли участь школи з усіх регіонів України. Завдяки цьому тисячі дітей та підлітків змогли долучитися до обговорення проблеми булінгу та спільно шукати шляхи її вирішення.

        Результати проекту демонструють, що використання документального кіно є ефективним інструментом для обговорення складних соціальних проблем та сприяє формуванню емпатії і критичного мислення в учнів.""",
                    "url": "https://bullyingstop.org.ua/news"
                }
            }
        }
    }
},


# КОРОБКА З МАТЕРІАЛАМИ
    "training": {
    "title": "📦 КОРОБКА З МАТЕРІАЛАМИ 📦",
    "submenu": {
        "exercises": {
            "title": "🎯 вправи"
        },
        "all_education": {
            "title": "🎓 анкети"
        },
        "educational_hours": {
            "title": "⏰ виховні години"
        },
        "info_materials": {
            "title": "📚 інформаційні матеріали"
        },
        "psychological_hours": {
            "title": "🧠 години спілкування"
        },
        "training_sessions": {
            "title": "✨ заняття"
        },
        "quests": {
            "title": "🎲 квести"
        },
        "summaries": {
            "title": "📝 конспекти"
        },
        "situation_sets": {
            "title": "🎭 набори ситуацій"
        },
        "trainings": {
            "title": "👥 тренінги"
        }
    }
},

# КОРИСНЕ З ДІЇ
    "diia_edu": {
    "title": "📱 КОРИСНЕ з ДІЯ.ОСВІТА 📱",
    "content": "Оберіть курс:",
    "submenu": {
        
        "personal_safety": {
            "title": "Особиста безпека підлітків",
            "description": """<b>"Особиста безпека підлітків"</b>

<i>Експерти: <b>Саша Гонтар</b></i>

Булінг, кібербулінг, залякування, погрози, кіберпереслідування, насильство в житті та мережі — чому це все не ок і що із цим робити?

У серіалі «Особиста безпека підлітків» ми розглянемо ключові ризики, які можуть трапитися з підлітками в реальному житті та мережі, а також розповімо, які життєві навички можливо прокачати, щоб протидіяти їм.

Освітній серіал створено з ініціативи Мінцифри для платформи Дія.Освіта за підтримки благодійного фонду «Клуб Добродіїв» та міжнародної гуманітарної організації Plan International.

Серіал про те, як захистити себе від ризиків у житті та мережі й прокачати життєві навички для протидії викликам.""",
            "url": "https://osvita.diia.gov.ua/courses/teenagers-personal-safety"
        },
        
        "school_no_bullying_teacher": {
            "title": "Школа без цькувань. Учителю",
            "description": """<b>"Школа без цькувань. Учителю"</b>

<i>Експерти: <b>Настя Мельниченко, Юлія Завгородня</b></i>

Цькування серед дітей — проблема як вчителів, так і батьків. Цей освітній серіал дасть вам дієві поради та методи, як боротися з булінгом, в тому числі в роботі з дітьми з емоційно-поведінковими особливостями.

Програма розроблена і для батьків, і для вчителів, щоб наочно пояснити, як говорити на цю тему з молодшими, як протидіяти цькуванню і, зрештою, як зробити так, щоб проблема булінгу лишилася в минулому.

Курс розроблено ГО «Студена» за ініціативи Міністерства цифрової трансформації України для платформи Дія.Освіта, за підтримки Міністерства науки та освіти України та проєкту «Дружній простір».

Серіал про те, як запобігти цькуванню: поради та стратегії для вчителів.""",
            "url": "https://osvita.diia.gov.ua/courses/skola-bez-ckuvan-castina-1-ucitelu"
        },
        
        "school_no_bullying_parents": {
            "title": "Школа без цькувань. Батькам",
            "description": """<b>"Школа без цькувань. Батькам"</b>

<i>Експерти: <b>Настя Мельниченко, Юлія Завгородня</b></i>

Цькування — спільна проблема вчителів, батьків та дітей. Цей освітній серіал дасть вам дієві поради та методи, як боротися з булінгом, в тому числі в роботі з дітьми з емоційно-поведінковими особливостями.

Програма розроблена і для батьків, і для вчителів, щоб наочно пояснити, як говорити на цю тему з молодшими, як протидіяти цькуванню і, зрештою, як зробити так, щоб проблема булінгу лишилася в минулому.

Курс розроблено ГО «Студена» за ініціативи Міністерства цифрової трансформації України для платформи Дія.Освіта, за підтримки Міністерства науки та освіти України та проєкту «Дружній простір».

Сераіал про те, як запобігти цькуванню: поради та стратегії для батьків.""",
            "url": "https://osvita.diia.gov.ua/courses/skola-bez-ckuvan-castina-2-batkam"
        },
        
        "cyberbullying": {
            "title": "Про кібербулінг для підлітків",
            "description": """<b>"Про кібербулінг для підлітків"</b>

<i>Експерти: <b>Анна Трінчер, Настя Каменських</b></i>

У справжній дружбі немає місця приниженням та неповазі, особливо онлайн. Якщо тебе образив коментар, повідомлення чи будь-що інше в мережі — це може бути кібербулінг. Не терпи це, це не окей.

Щоб не помилитися, переглянь освітній серіал. Тут можна зрозуміти, як виглядає кібербулінг, які його причини та потенційні наслідки, та як припинити булінг в інтернеті.

Якщо від цькувань в інтернеті страждають твої друзі — окрема серія буде присвячена тому, як їм допомогти. Не дозволяй кривдникам тебе образити! Проєкт Міністерства цифрової трансформації України за підтримки ЮНІСЕФ в Україні.

Серіал про те, як протистояти буллінгу в інтернеті.""",
            "url": "https://osvita.diia.gov.ua/courses/cyberbullying"
        }
    }
},

# ГО ТРИКУТНИК
    "triangle": {
    "title": "🔺 ГО «ТРИКУТНИК» 🔺",
    "content": """ <b>"Трикутник" - платформа співдії освіти, культури та правозахисту.</b>

Контакти:
- <a href="tel:+380990889198">0990889198</a>
- trykutnyk.fest@gmail.com

Адреса:
- вул. Братів Білоусів 11, приміщення 12, Коломия, Україна""",
    
    "links": {
        "telegram": "https://t.me/ngo_trykutnyk",
        "facebook": "https://www.facebook.com/trykutnyk",
        "instagram": "https://www.instagram.com/triangle_ngo",
        "vulyk": "https://www.instagram.com/vulykzmistiv",
        "youth_space": "https://www.instagram.com/molod.prostir.klm"
    }
}
    
}

# Структура для підменю тренінгів
TRAINING_SUBMENUS = {
    "submenu_type": {
        "title": "Категорії матеріалів",
        "options": {
            "exercises": "📍 вправи",
            "all_education": "📍 анкети",
            "educational_hours": "📍 виховні години",
            "info_materials": "📍 інформаційні матеріали",
            "psychological_hours": "📍 психологічні години",
            "training_sessions": "📍 заняття",
            "quests": "📍 квести",
            "summaries": "📍 конспекти",
            "situation_sets": "📍 набори ситуацій",
            "trainings": "📍 тренінги"
        }
    }
}

# Структура для підменю занять
LESSONS_SUBMENUS = {
    "age_groups": {
        "title": "Заняття за віком",
        "options": {
            "primary": "Початкова школа",
            "middle": "Середня школа",
            "high": "Старша школа"
        }
    },
    "duration": {
        "title": "Заняття за тривалістю",
        "options": {
            "short": "15-30 хвилин",
            "medium": "30-45 хвилин",
            "long": "45-60 хвилин"
        }
    },
    "target_group": {
        "title": "За цільовою групою",
        "options": {
            "students": "Для учнів",
            "teachers": "Для вчителів",
            "parents": "Для батьків"
        }
    }
}

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує головне меню"""
    keyboard = [
        [InlineKeyboardButton(MENU_DATA["what_to_do"]["title"], callback_data="what_to_do")],
        [InlineKeyboardButton(MENU_DATA["calling"]["title"], callback_data="calling")],
        [InlineKeyboardButton(MENU_DATA["normative"]["title"], callback_data="normative")],
        [InlineKeyboardButton(MENU_DATA["manuals_categories"]["title"], callback_data="manuals_categories")],
        [InlineKeyboardButton(MENU_DATA["cyberbullying"]["title"], callback_data="cyberbullying")],
        [InlineKeyboardButton(MENU_DATA["training"]["title"], callback_data="training")],
        [InlineKeyboardButton(MENU_DATA["diia_edu"]["title"], callback_data="diia_edu")],
        [InlineKeyboardButton(MENU_DATA["triangle"]["title"], callback_data="triangle")]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text(
        "Привіт! Я твій бот-помічник у питаннях булінгу. Тут Ти зможеш знайти все необхідне. Обери розділ:",
        reply_markup=reply_markup,
        parse_mode='HTML'
    )

async def handle_button(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    
    # Обробка розділу "ЩО РОБИТИ ЯКЩО"
    if query.data == "what_to_do":
        return await show_algorithm_menu(update, context)
        
    # Обробка вибору розділу алгоритму
    if query.data.startswith("algorithm_section_"):
        section_key = query.data.replace("algorithm_section_", "")
        return await show_algorithm_section(update, context, section_key)
        
    # Обробка вибору кроку в розділі "ПЕРШІ КРОКИ"
    if query.data.startswith("algorithm_step_"):
        step_key = query.data.replace("algorithm_step_", "")
        return await show_algorithm_step(update, context, step_key)
        
    # Обробка вибору ситуації в розділі "ПРИКЛАДИ СИТУАЦІЙ"
    if query.data.startswith("algorithm_situation_"):
        situation_key = query.data.replace("algorithm_situation_", "")
        return await show_algorithm_situation(update, context, situation_key)
        
    # Обробка вибору підрозділу в розділі "КОМІСІЯ І ЗАСІДАННЯ"
    if query.data.startswith("algorithm_committee_subsection_"):
        subsection_key = query.data.replace("algorithm_committee_subsection_", "")
        return await show_committee_subsection(update, context, subsection_key)

    # Обробка розділу ПОСІБНИКИ
    if query.data == "manuals_categories":
        return await show_manuals_categories(update, context)

    # Обробка вибору конкретної категорії
    if query.data.startswith("manuals_category_"):
        category_key = query.data.replace("manuals_category_", "")
        return await show_category_manuals(update, context, category_key)

    # Обробка вибору конкретного посібника
    if query.data.startswith("manual_"):
        print(f"Обробляю callback для посібника: {query.data}")
    
    # Перевіряємо всі можливі категорії
    found = False
    for category_key in MENU_DATA["manuals_categories"]["categories"].keys():
        category_prefix = f"manual_{category_key}_"
        if query.data.startswith(category_prefix):
            # Витягуємо ключ посібника - це все, що після префіксу категорії
            manual_key = query.data[len(category_prefix):]
            print(f"Знайдено: категорія={category_key}, посібник={manual_key}")
            found = True
            return await show_manual_details(update, context, category_key, manual_key)
    
    if not found:
        print(f"Не вдалося знайти відповідну категорію для {query.data}")
        await query.answer("Помилка: не вдалося знайти посібник")

    # Додайте це до функції handle_button
    if query.data == "cyberbullying":
        return await show_cyberbullying_menu(update, context)

    if query.data == "cyberbullying_menu":
        return await show_cyberbullying_menu(update, context)

    if query.data == "cyberbullying_questions":
        return await show_cyberbullying_questions(update, context)

    if query.data.startswith("cyberbullying_question_"):
        question_key = query.data.replace("cyberbullying_question_", "")
        return await show_cyberbullying_question(update, context, question_key)

    if query.data == "cyberbullying_resources":
        return await show_cyberbullying_resources(update, context)

    if query.data == "cyberbullying_campaign":
        return await show_cyberbullying_campaign(update, context)

    if query.data.startswith("cyberbullying_campaign_material_"):
        material_key = query.data.replace("cyberbullying_campaign_material_", "")
        return await show_cyberbullying_campaign_material(update, context, material_key)

    if query.data == "cyberbullying_docu_week":
        return await show_cyberbullying_docu_week(update, context)

    if query.data.startswith("cyberbullying_docu_week_material_"):
        material_key = query.data.replace("cyberbullying_docu_week_material_", "")
        return await show_cyberbullying_docu_week_material(update, context, material_key)

    if query.data == "training":
        return await show_training_menu(update, context)

    # Обробка вибору категорії матеріалів
    if query.data.startswith("training_category_"):
        category_key = query.data.replace("training_category_", "")
        return await show_training_category(update, context, category_key)    

    # Інші обробники
    if query.data == "diia_edu":
        return await show_diia_edu_menu(update, context)
        
    # Обробка вибору конкретного курсу
    if query.data.startswith("diia_edu_"):
        course_key = query.data.replace("diia_edu_", "")
        course = MENU_DATA["diia_edu"]["submenu"].get(course_key)
        
        if course:
            keyboard = [
                [InlineKeyboardButton("📱 Перейти до курсу", url=course["url"])],
                [InlineKeyboardButton("◀️ Назад до списку курсів", callback_data="diia_edu")]
            ]
            reply_markup = InlineKeyboardMarkup(keyboard)
            
            await query.edit_message_text(
                text=course["description"],
                reply_markup=reply_markup,
                parse_mode='HTML',
                disable_web_page_preview=True
            )
            return

    if query.data == "triangle":
        keyboard = [
            [
                InlineKeyboardButton("📱 Telegram", url=MENU_DATA["triangle"]["links"]["telegram"]),
                InlineKeyboardButton("📘 Facebook", url=MENU_DATA["triangle"]["links"]["facebook"]),
                InlineKeyboardButton("📸 Instagram", url=MENU_DATA["triangle"]["links"]["instagram"])
            ],
            [
                InlineKeyboardButton("🎯 Вулик Змістів", url=MENU_DATA["triangle"]["links"]["vulyk"]),
                InlineKeyboardButton("🌟 Молодіжний простір Коломиї", url=MENU_DATA["triangle"]["links"]["youth_space"])
            ],
            [InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        full_text = f"""{MENU_DATA["triangle"]["content"]}

<b>Приєднуйтеся до нашої спільноти або до спільнот наших ініціатив:</b>"""
        
        try:
            await query.edit_message_text(
                text=full_text,
                reply_markup=reply_markup,
                parse_mode='HTML',
                disable_web_page_preview=True
            )
        except Exception as e:
            await query.message.reply_text(
                text=full_text,
                reply_markup=reply_markup,
                parse_mode='HTML',
                disable_web_page_preview=True
            )
        return
        
    if query.data == "main_menu":
        return await show_main_menu(update, context)
    
    if query.data == "lessons":
        return await show_lessons_menu(update, context)
    
    if query.data == "training":
        return await show_training_menu(update, context)
    
    if query.data in LESSONS_SUBMENUS:
        return await show_submenu(update, context, query.data)
    
    if query.data in TRAINING_SUBMENUS["submenu_type"]["options"]:
        return await show_training_submenu(update, context, query.data)
    
    # Обробка вибору конкретної ролі
    if query.data == "what_to_do":
        return await show_what_to_do_menu(update, context)
    
    if query.data.startswith("what_to_do_"):
        role_key = query.data.replace("what_to_do_", "")
        role = MENU_DATA["what_to_do"]["submenu"].get(role_key)
        
        if role:
            keyboard = [
                [InlineKeyboardButton("◀️ Назад до вибору ролі", callback_data="what_to_do")]
            ]
            reply_markup = InlineKeyboardMarkup(keyboard)
            
            await query.edit_message_text(
                text=role["description"],
                reply_markup=reply_markup,
                parse_mode='HTML',
                disable_web_page_preview=True
            )
            return
    
    # Показуємо інформацію з основного меню
    menu_item = MENU_DATA.get(query.data)
    if menu_item:
        keyboard = [[InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.edit_message_text(
            text=menu_item.get("content", "Інформація відсутня"),
            reply_markup=reply_markup,
            parse_mode='HTML',
            disable_web_page_preview=True
        )



# Додайте ці нові функції після існуючих функцій у вашому коді

async def show_algorithm_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує меню алгоритму дій при підозрі булінгу"""
    query = update.callback_query
    algorithm = MENU_DATA["what_to_do"]["submenu"]["algorithm"]
    keyboard = []
    
    # Додаємо кнопки для кожного розділу алгоритму
    for key, section in algorithm["subsections"].items():
        keyboard.append([InlineKeyboardButton(section["title"], callback_data=f"algorithm_section_{key}")])
    
    # Додаємо кнопку повернення до вибору ролі
    keyboard.append([InlineKeyboardButton("◀️ Назад до вибору ролі", callback_data="what_to_do")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=algorithm["description"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_algorithm_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує меню алгоритму дій при підозрі булінгу"""
    query = update.callback_query
    data = MENU_DATA["what_to_do"]
    keyboard = []
    
    # Додаємо кнопки для кожного розділу алгоритму
    for key, section in data["sections"].items():
        keyboard.append([InlineKeyboardButton(section["title"], callback_data=f"algorithm_section_{key}")])
    
    # Додаємо кнопку повернення до головного меню
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=data["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

# Функція відображення розділу алгоритму
async def show_algorithm_section(update: Update, context: ContextTypes.DEFAULT_TYPE, section_key: str):
    """Показує вміст обраного розділу алгоритму"""
    query = update.callback_query
    section = MENU_DATA["what_to_do"]["sections"].get(section_key)
    
    if not section:
        await query.answer("Розділ не знайдено")
        return
    
    keyboard = []
    
    # Якщо це розділ "ПЕРШІ КРОКИ", показуємо кнопки для кожного кроку в одному рядку, тільки з емодзі
    if section_key == "first_steps" and "steps" in section:
        step_buttons = []
        # Словник відповідності емодзі цифр
        number_emojis = {
            "step1": "1️⃣",
            "step2": "2️⃣",
            "step3": "3️⃣"
        }
        
        for step_key, step in section["steps"].items():
            # Використовуємо тільки емодзі без текстових підписів
            button_text = number_emojis.get(step_key, "")
            step_buttons.append(InlineKeyboardButton(button_text, callback_data=f"algorithm_step_{step_key}"))
        
        # Розміщуємо всі кнопки в одному рядку
        keyboard.append(step_buttons)
    
    # Якщо це розділ "ПРИКЛАДИ СИТУАЦІЙ", показуємо кнопки для кожної ситуації в одному рядку, тільки з емодзі
    elif section_key == "situations" and "examples" in section:
        situation_buttons = []
        # Словник відповідності емодзі цифр для ситуацій
        number_emojis = {
            "situation1": "1️⃣",
            "situation2": "2️⃣",
            "situation3": "3️⃣"
        }
        
        for situation_key, situation in section["examples"].items():
            # Використовуємо тільки емодзі без текстових підписів
            button_text = number_emojis.get(situation_key, "")
            situation_buttons.append(InlineKeyboardButton(button_text, callback_data=f"algorithm_situation_{situation_key}"))
        
        # Розміщуємо всі кнопки в одному рядку
        keyboard.append(situation_buttons)
    
    # Якщо це розділ "КОМІСІЯ І ЗАСІДАННЯ", показуємо кнопки для підрозділів
    elif section_key == "committee" and "subsections" in section:
        for subsection_key, subsection in section["subsections"].items():
            keyboard.append([InlineKeyboardButton(subsection["title"], callback_data=f"algorithm_committee_subsection_{subsection_key}")])
    
    # Додаємо кнопку повернення до меню алгоритму
    keyboard.append([InlineKeyboardButton("◀️ Назад до алгоритму", callback_data="what_to_do")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    # Оновлюємо вміст розділів з додатковим ввідним текстом
    content_text = section["content"]
    
    if section_key == "first_steps":
        content_text = """<b>ПЕРШІ КРОКИ</b>

У випадках підозри чи виявлення булінгу важливо діяти швидко та послідовно. Своєчасне реагування допомагає захистити постраждалу дитину та запобігти подальшому розвитку конфлікту.

Нижче наведено покроковий алгоритм дій, розроблений згідно з офіційними рекомендаціями МОН України. Дотримання цих кроків допоможе забезпечити ефективне реагування на ситуацію булінгу в закладі освіти.

Оберіть конкретний крок для отримання детальної інформації:"""
    
    elif section_key == "situations":
        content_text = """<b>ПРИКЛАДИ СИТУАЦІЙ</b>

Для кращого розуміння практичного застосування алгоритму дій при булінгу пропонуємо розглянути реальні ситуації, які виникають у закладах освіти. 

У цих прикладах розглянуто типові помилки в реагуванні та наведено правильні підходи до вирішення проблеми. Аналіз таких ситуацій допоможе вам уникнути поширених помилок і діяти ефективно при виявленні випадків булінгу.

Оберіть ситуацію для ознайомлення:"""
    
    await query.edit_message_text(
        text=content_text,
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )


# Функція відображення кроку
async def show_algorithm_step(update: Update, context: ContextTypes.DEFAULT_TYPE, step_key: str):
    """Показує вміст обраного кроку з розділу 'ПЕРШІ КРОКИ'"""
    query = update.callback_query
    
    # Отримуємо інформацію про крок
    step = MENU_DATA["what_to_do"]["sections"]["first_steps"]["steps"].get(step_key)
    
    if not step:
        await query.answer("Крок не знайдено")
        return
    
    # Створюємо навігаційні кнопки в залежності від поточного кроку
    keyboard = []
    
    if step_key == "step1":
        # Для першого кроку показуємо тільки "Наступний крок"
        keyboard.append([
            InlineKeyboardButton("Наступний крок ▶️", callback_data="algorithm_step_step2")
        ])
    elif step_key == "step2":
        # Для другого кроку показуємо "Попередній крок" та "Наступний крок"
        keyboard.append([
            InlineKeyboardButton("◀️ Попередній крок", callback_data="algorithm_step_step1"),
            InlineKeyboardButton("Наступний крок ▶️", callback_data="algorithm_step_step3")
        ])
    elif step_key == "step3":
        # Для третього кроку показуємо тільки "Попередній крок"
        keyboard.append([
            InlineKeyboardButton("◀️ Попередній крок", callback_data="algorithm_step_step2")
        ])
    
    # Додаємо кнопку повернення до розділу "ПЕРШІ КРОКИ"
    keyboard.append([InlineKeyboardButton("◀️ Назад до ПЕРШИХ КРОКІВ", callback_data="algorithm_section_first_steps")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=step["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

# Функція відображення ситуації
async def show_algorithm_situation(update: Update, context: ContextTypes.DEFAULT_TYPE, situation_key: str):
    """Показує вміст обраної ситуації з розділу 'ПРИКЛАДИ СИТУАЦІЙ'"""
    query = update.callback_query
    
    # Отримуємо інформацію про ситуацію
    situation = MENU_DATA["what_to_do"]["sections"]["situations"]["examples"].get(situation_key)
    
    if not situation:
        await query.answer("Ситуація не знайдена")
        return
    
    # Додаємо кнопку повернення до розділу "ПРИКЛАДИ СИТУАЦІЙ"
    keyboard = [[InlineKeyboardButton("◀️ Назад до ПРИКЛАДІВ СИТУАЦІЙ", callback_data="algorithm_section_situations")]]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=situation["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

# Функція відображення підрозділу комісії
async def show_committee_subsection(update: Update, context: ContextTypes.DEFAULT_TYPE, subsection_key: str):
    """Показує вміст обраного підрозділу з розділу 'КОМІСІЯ І ЗАСІДАННЯ'"""
    query = update.callback_query
    
    # Отримуємо інформацію про підрозділ
    subsection = MENU_DATA["what_to_do"]["sections"]["committee"]["subsections"].get(subsection_key)
    
    if not subsection:
        await query.answer("Підрозділ не знайдено")
        return
    
    # Додаємо кнопку повернення до розділу "КОМІСІЯ І ЗАСІДАННЯ"
    keyboard = [[InlineKeyboardButton("◀️ Назад до КОМІСІЇ І ЗАСІДАННЯ", callback_data="algorithm_section_committee")]]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=subsection["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )



async def show_manuals_categories(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує категорії посібників"""
    query = update.callback_query
    keyboard = []
    
    # Додайте вивід для перевірки
    print("Доступні категорії:", MENU_DATA["manuals_categories"]["categories"].keys())
    
    for key, category in MENU_DATA["manuals_categories"]["categories"].items():
        # Додайте вивід для перевірки
        print(f"Створюю кнопку для категорії: {key} - {category['title']}")
        print(f"Callback data: manuals_category_{key}")
        
        keyboard.append([InlineKeyboardButton(category["title"], callback_data=f"manuals_category_{key}")])
    
    # Додаємо кнопку повернення до головного меню
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["manuals_categories"]["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_category_manuals(update: Update, context: ContextTypes.DEFAULT_TYPE, category_key: str):
    """Показує посібники обраної категорії"""
    query = update.callback_query
    
    print(f"Показую категорію: {category_key}")
    
    category = MENU_DATA["manuals_categories"]["categories"].get(category_key)
    if not category:
        print(f"Категорія не знайдена: {category_key}")
        await query.answer("Категорія не знайдена")
        return
    
    keyboard = []
    
    # Додаємо кнопки для кожного посібника в категорії
    for key, manual in category["materials"].items():
        print(f"Додаю посібник: {key} - {manual['title']}")
        keyboard.append([InlineKeyboardButton(manual["title"], callback_data=f"manual_{category_key}_{key}")])
    
    # Додаємо кнопку повернення до категорій
    keyboard.append([InlineKeyboardButton("◀️ Назад до категорій", callback_data="manuals_categories")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=f"<b>{category['title']}</b>\n\n{category['description']}",
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_manual_details(update: Update, context: ContextTypes.DEFAULT_TYPE, category_key: str, manual_key: str):
    """Показує деталі конкретного посібника"""
    query = update.callback_query
    
    print(f"Показую деталі посібника: категорія={category_key}, посібник={manual_key}")
    
    try:
        manual = MENU_DATA["manuals_categories"]["categories"][category_key]["materials"][manual_key]
        
        keyboard = [
            [InlineKeyboardButton("📥 ПЕРЕГЛЯНУТИ PDF", url=manual["pdf_url"])],
            [InlineKeyboardButton("◀️ Назад до списку", callback_data=f"manuals_category_{category_key}")]
        ]
        
        reply_markup = InlineKeyboardMarkup(keyboard)
        
        await query.edit_message_text(
            text=manual["description"],
            reply_markup=reply_markup,
            parse_mode='HTML',
            disable_web_page_preview=True
        )
    except KeyError as e:
        # Додайте логування для відстеження помилки
        print(f"KeyError in show_manual_details: {e}")
        print(f"Category key: {category_key}, Manual key: {manual_key}")
        await query.answer(f"Посібник не знайдено. Помилка: {e}")


async def show_cyberbullying_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує меню кібербулінгу"""
    query = update.callback_query
    
    keyboard = [
        [InlineKeyboardButton(MENU_DATA["cyberbullying"]["submenu"]["questions"]["title"], callback_data="cyberbullying_questions")],
        # Видаліть цю лінію:
        # [InlineKeyboardButton(MENU_DATA["cyberbullying"]["submenu"]["video_course"]["title"], url=MENU_DATA["cyberbullying"]["submenu"]["video_course"]["url"])],
        [InlineKeyboardButton(MENU_DATA["cyberbullying"]["submenu"]["resources"]["title"], callback_data="cyberbullying_resources")],
        [InlineKeyboardButton(MENU_DATA["cyberbullying"]["submenu"]["campaign_materials"]["title"], callback_data="cyberbullying_campaign")],
        [InlineKeyboardButton(MENU_DATA["cyberbullying"]["submenu"]["docu_week"]["title"], callback_data="cyberbullying_docu_week")],
        [InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["cyberbullying"]["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_questions(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує список питань про кібербулінг"""
    query = update.callback_query
    
    # Створюємо по 2 кнопки в ряд для кращого відображення
    keyboard = []
    row = []
    
    questions = MENU_DATA["cyberbullying"]["submenu"]["questions"]["questions"]
    for i, (key, question) in enumerate(questions.items(), 1):
        if i % 2 == 1:  # Початок нового рядка
            row = [InlineKeyboardButton(f"{i}. {question['short_title']}", callback_data=f"cyberbullying_question_{key}")]
        else:  # Додаємо другу кнопку і зберігаємо рядок
            row.append(InlineKeyboardButton(f"{i}. {question['short_title']}", callback_data=f"cyberbullying_question_{key}"))
            keyboard.append(row)
    
    # Додаємо останній непарний рядок якщо він є
    if len(questions) % 2 == 1:
        keyboard.append(row)
    
    # Додаємо кнопку повернення
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню кібербулінгу", callback_data="cyberbullying_menu")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["cyberbullying"]["submenu"]["questions"]["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_question(update: Update, context: ContextTypes.DEFAULT_TYPE, question_key: str):
    """Показує вміст конкретного питання про кібербулінг"""
    query = update.callback_query
    
    # Отримуємо інформацію про питання
    question = MENU_DATA["cyberbullying"]["submenu"]["questions"]["questions"].get(question_key)
    
    if not question:
        await query.answer("Питання не знайдено")
        return
    
    # Визначаємо поточний індекс і загальну кількість питань
    questions = list(MENU_DATA["cyberbullying"]["submenu"]["questions"]["questions"].keys())
    current_index = questions.index(question_key)
    total_questions = len(questions)
    
    # Створюємо навігаційні кнопки
    keyboard = []
    
    # Додаємо кнопки навігації між питаннями
    navigation_row = []
    
    # Додаємо кнопку "Попереднє", якщо це не перше питання
    if current_index > 0:
        prev_key = questions[current_index - 1]
        navigation_row.append(InlineKeyboardButton("◀️ Попереднє", callback_data=f"cyberbullying_question_{prev_key}"))
    
    # Додаємо кнопку "Наступне", якщо це не останнє питання
    if current_index < total_questions - 1:
        next_key = questions[current_index + 1]
        navigation_row.append(InlineKeyboardButton("Наступне ▶️", callback_data=f"cyberbullying_question_{next_key}"))
    
    if navigation_row:
        keyboard.append(navigation_row)
    
    # Додаємо кнопку повернення до списку питань
    keyboard.append([InlineKeyboardButton("◀️ Назад до списку питань", callback_data="cyberbullying_questions")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=question["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_campaign(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує матеріали кампанії проти кібербулінгу"""
    query = update.callback_query
    
    # Отримуємо всі матеріали
    materials = list(MENU_DATA["cyberbullying"]["submenu"]["campaign_materials"]["materials"].items())
    
    # Розділяємо матеріали на пари (по 2 кнопки в ряд)
    keyboard = []
    for i in range(0, len(materials), 2):
        row = []
        # Додаємо першу кнопку в ряд
        key1, material1 = materials[i]
        row.append(InlineKeyboardButton(material1["title"], callback_data=f"cyberbullying_campaign_material_{key1}"))
        
        # Додаємо другу кнопку, якщо вона є
        if i + 1 < len(materials):
            key2, material2 = materials[i + 1]
            row.append(InlineKeyboardButton(material2["title"], callback_data=f"cyberbullying_campaign_material_{key2}"))
        
        keyboard.append(row)
    
    # Додаємо кнопку повернення до меню кібербулінгу
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню кібербулінгу", callback_data="cyberbullying")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["cyberbullying"]["submenu"]["campaign_materials"]["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_campaign_material(update: Update, context: ContextTypes.DEFAULT_TYPE, material_key: str):
    """Показує конкретний матеріал кампанії проти кібербулінгу"""
    query = update.callback_query
    
    # Отримуємо інформацію про матеріал
    material = MENU_DATA["cyberbullying"]["submenu"]["campaign_materials"]["materials"].get(material_key)
    
    if not material:
        await query.answer("Матеріал не знайдено")
        return
    
    # Створюємо кнопки тільки для повернення назад
    keyboard = [
        [InlineKeyboardButton("◀️ Назад до списку матеріалів", callback_data="cyberbullying_campaign")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=material["description"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_docu_week(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує інформацію про шкільний DOCU/ТИЖДЕНЬ"""
    query = update.callback_query
    
    keyboard = []
    
    # Додаємо кнопки для кожного типу матеріалів
    for key, material in MENU_DATA["cyberbullying"]["submenu"]["docu_week"]["materials"].items():
        keyboard.append([InlineKeyboardButton(material["title"], callback_data=f"cyberbullying_docu_week_material_{key}")])
    
    # Додаємо кнопку повернення до меню кібербулінгу
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню кібербулінгу", callback_data="cyberbullying")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["cyberbullying"]["submenu"]["docu_week"]["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_docu_week_material(update: Update, context: ContextTypes.DEFAULT_TYPE, material_key: str):
    """Показує конкретний матеріал шкільного DOCU/ТИЖНЯ"""
    query = update.callback_query
    
    # Отримуємо інформацію про матеріал
    material = MENU_DATA["cyberbullying"]["submenu"]["docu_week"]["materials"].get(material_key)
    
    if not material:
        await query.answer("Матеріал не знайдено")
        return
    
    # Створюємо кнопки
    keyboard = [
        [InlineKeyboardButton("📥 Переглянути матеріали", url=material["url"])],
        [InlineKeyboardButton("◀️ Назад до DOCU/ТИЖНЯ", callback_data="cyberbullying_docu_week")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=material["description"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_cyberbullying_resources(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує ресурси для допомоги при кібербулінгу"""
    query = update.callback_query
    
    keyboard = [
        [InlineKeyboardButton("◀️ Назад до меню кібербулінгу", callback_data="cyberbullying_menu")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["cyberbullying"]["submenu"]["resources"]["description"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )


# Оновлена функція show_what_to_do_menu
async def show_what_to_do_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує меню вибору ролі та алгоритму дій"""
    query = update.callback_query
    keyboard = []
    
    # Додаємо кнопку для алгоритму дій першим пунктом
    algorithm = MENU_DATA["what_to_do"]["submenu"].get("algorithm")
    if algorithm:
        keyboard.append([InlineKeyboardButton(algorithm["title"], callback_data="what_to_do_algorithm")])
    
    # Додаємо кнопки для кожної ролі
    for key, item in MENU_DATA["what_to_do"]["submenu"].items():
        # Пропускаємо алгоритм, оскільки ми вже додали його вище
        if key != "algorithm":
            keyboard.append([InlineKeyboardButton(item["title"], callback_data=f"what_to_do_{key}")])
    
    # Додаємо кнопку повернення до головного меню
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=MENU_DATA["what_to_do"]["content"],
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )


async def show_training_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує підменю розділу КОРОБКА З МАТЕРІАЛАМИ"""
    query = update.callback_query
    keyboard = []
    
    # Створюємо список категорій
    categories = [
        {"key": "exercises", "title": "🎯 Вправи"},
        {"key": "all_education", "title": "🎓 Анкети"},
        {"key": "educational_hours", "title": "⏰ Виховні години"},
        {"key": "info_materials", "title": "📚 Інформаційні матеріали"},
        {"key": "psychological_hours", "title": "🧠 Години спілкування"},
        {"key": "training_sessions", "title": "✨ Заняття"},
        {"key": "quests", "title": "🎲 Квести"},
        {"key": "summaries", "title": "📝 Конспекти"},
        {"key": "situation_sets", "title": "🎭 Набори ситуацій"},
        {"key": "trainings", "title": "👥 Тренінги"}
    ]
    
    # Розміщуємо кнопки по дві в ряд
    for i in range(0, len(categories), 2):
        row = []
        # Додаємо першу кнопку в ряд
        row.append(InlineKeyboardButton(
            categories[i]["title"], 
            callback_data=f"training_category_{categories[i]['key']}"
        ))
        
        # Додаємо другу кнопку, якщо вона є
        if i + 1 < len(categories):
            row.append(InlineKeyboardButton(
                categories[i+1]["title"], 
                callback_data=f"training_category_{categories[i+1]['key']}"
            ))
            
        keyboard.append(row)
    
    # Додаємо кнопку повернення до головного меню
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text="<b>📦 КОРОБКА З МАТЕРІАЛАМИ 📦</b>\n\nОберіть категорію матеріалів:",
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_training_category(update: Update, context: ContextTypes.DEFAULT_TYPE, category_key: str):
    """Показує заглушку для обраної категорії матеріалів"""
    query = update.callback_query
    
    # Словник з назвами категорій
    category_names = {
        "exercises": "🎯 Вправи",
        "all_education": "🎓 Анкети",
        "educational_hours": "⏰ Виховні години",
        "info_materials": "📚 Інформаційні матеріали",
        "psychological_hours": "🧠 Години спілкування",
        "training_sessions": "✨ Заняття",
        "quests": "🎲 Квести",
        "summaries": "📝 Конспекти",
        "situation_sets": "🎭 Набори ситуацій",
        "trainings": "👥 Тренінги"
    }
    
    category_title = category_names.get(category_key, "Категорія")
    
    keyboard = [
        [InlineKeyboardButton("◀️ Назад до категорій", callback_data="training")]
    ]
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text=f"<b>{category_title}</b>\n\nМатеріали для цієї категорії готуються і будуть доступні найближчим часом.",
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

async def show_main_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує головне меню"""
    query = update.callback_query
    keyboard = [
        [InlineKeyboardButton(MENU_DATA["what_to_do"]["title"], callback_data="what_to_do")],
        [InlineKeyboardButton(MENU_DATA["calling"]["title"], callback_data="calling")],
        [InlineKeyboardButton(MENU_DATA["normative"]["title"], callback_data="normative")],
        [InlineKeyboardButton(MENU_DATA["manuals_categories"]["title"], callback_data="manuals_categories")],
        [InlineKeyboardButton(MENU_DATA["cyberbullying"]["title"], callback_data="cyberbullying")],
        [InlineKeyboardButton(MENU_DATA["training"]["title"], callback_data="training")],
        [InlineKeyboardButton(MENU_DATA["diia_edu"]["title"], callback_data="diia_edu")],
        [InlineKeyboardButton(MENU_DATA["triangle"]["title"], callback_data="triangle")]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text="Оберіть розділ:",
        reply_markup=reply_markup,
        disable_web_page_preview=True
    )


async def show_lessons_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує меню занять"""
    query = update.callback_query
    keyboard = [
        [InlineKeyboardButton("📚 За віком", callback_data="age_groups")],
        [InlineKeyboardButton("⏱ За тривалістю", callback_data="duration")],
        [InlineKeyboardButton("👥 За цільовою групою", callback_data="target_group")],
        [InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text="Оберіть категорію занять:",
        reply_markup=reply_markup,
        disable_web_page_preview=True
    )

async def show_submenu(update: Update, context: ContextTypes.DEFAULT_TYPE, submenu_type: str):
    """Показує підменю для обраної категорії занять"""
    query = update.callback_query
    submenu = LESSONS_SUBMENUS[submenu_type]
    
    keyboard = [
        [InlineKeyboardButton(text, callback_data=f"{submenu_type}_{key}")]
        for key, text in submenu["options"].items()
    ]
    keyboard.append([InlineKeyboardButton("◀️ Назад", callback_data="lessons")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.edit_message_text(
        text=f"{submenu['title']}:",
        reply_markup=reply_markup,
        disable_web_page_preview=True
    )

async def clear_chat(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Очищає чат"""
    await update.message.reply_text("Чат очищено!")

async def restart_bot(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Перезапускає бота"""
    await update.message.reply_text("Бота перезапущено!")
    await start(update, context)

async def stop_bot(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Зупиняє бота"""
    await update.message.reply_text("Бота зупинено. Щоб почати знову, напишіть /start")

async def show_diia_edu_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Показує підменю розділу ДІЯ.ОСВІТА"""
    query = update.callback_query
    keyboard = []
    
    # Додаємо кнопки для кожного курсу
    for key, item in MENU_DATA["diia_edu"]["submenu"].items():
        keyboard.append([InlineKeyboardButton(item["title"], callback_data=f"diia_edu_{key}")])
    
    # Додаємо кнопку повернення до головного меню
    keyboard.append([InlineKeyboardButton("◀️ Назад до меню", callback_data="main_menu")])
    
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(
        text="Оберіть курс на платформі ДІЯ.ОСВІТА:",
        reply_markup=reply_markup,
        parse_mode='HTML',
        disable_web_page_preview=True
    )

def run_bot():
    """Запускає бота"""
    max_retries = 3
    retry_count = 0
    
    while retry_count < max_retries:
        try:
            application = Application.builder().token(TOKEN).build()
            
            application.add_handler(CommandHandler("start", start))
            application.add_handler(CallbackQueryHandler(handle_button))
            application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, start))
            
            print("Бот запускається...")
            application.run_polling()
            break
            
        except Conflict:
            retry_count += 1
            print(f"Спроба {retry_count} з {max_retries}: Бот вже запущений. Очікування...")
            time.sleep(10)  # Чекаємо 10 секунд перед повторною спробою
            
    if retry_count == max_retries:
        print("Не вдалося запустити бота після кількох спроб. Переконайтеся, що немає інших запущених екземплярів.")

    application = Application.builder().token(TOKEN).build()
    
    # Додаємо обробники команд
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("clear", clear_chat))
    application.add_handler(CommandHandler("restart", restart_bot))
    application.add_handler(CommandHandler("stop", stop_bot))
    application.add_handler(CallbackQueryHandler(handle_button))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, start))
    
    # Запускаємо бота
    application.run_polling()

if __name__ == "__main__":
    run_bot()